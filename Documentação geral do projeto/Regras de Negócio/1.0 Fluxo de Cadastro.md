# ğŸ“Œ Regras de NegÃ³cio â€“ Fluxo de Cadastro ConectaBem

> Sistema: ConectaBem

> VersÃ£o: 1.0

> Relacionado: [Fluxo de Cadastro](https://www.figma.com/design/NtXWClFNNGscXzSd38vwmX/Squad-Design_ConectaBem_v.28.07.25?node-id=8462-94204)

---


## 1. Cadastro via Provedores (Google / Facebook)

- O sistema deve permitir autenticaÃ§Ã£o apenas atravÃ©s de contas vÃ¡lidas do Google ou Facebook.
- O sistema deve validar a permissÃ£o do usuÃ¡rio para compartilhar os dados bÃ¡sicos (nome, e-mail).
- Se o usuÃ¡rio nÃ£o conceder permissÃ£o, o cadastro nÃ£o poderÃ¡ ser concluÃ­do.
- ApÃ³s autenticaÃ§Ã£o bem-sucedida, o usuÃ¡rio deve obrigatoriamente selecionar o perfil (â€œPacienteâ€ ou â€œMÃ©dicoâ€) antes de prosseguir.
- Um Pop over explicativo de perfis deve estar no primeiro momento em que o usuÃ¡rio vai fazer a escolha do tipo de perfil.

---

## 2. Cadastro via E-mail

- O sistema deve validar o formato do e-mail antes de permitir a continuaÃ§Ã£o do cadastro.

### 2.1 Validade do CÃ³digo

- O sistema deve enviar um cÃ³digo de validaÃ§Ã£o ao e-mail informado.
- SerÃ¡ mostrada uma mensagem com o tempo mÃ¡ximo de validade do cÃ³digo de verificaÃ§Ã£o.
  - DeverÃ¡ ser exibida em contagem regressiva de segundos.
- Cada novo cÃ³digo gerado deve invalidar o anterior.
- A contagem de expiraÃ§Ã£o (tempo recomendado entre 30 segundos e 5 minutos â€“ conforme [artigo](https://arkesel.com/securing-transactions-with-otp-apis-10-best-practices/?utm_source=chatgpt.com)) deve reiniciar a cada reenvio.
- TÃ­tulo e texto da pÃ¡gina devem fornecer feedback para o usuÃ¡rio de que um novo cÃ³digo foi enviado e o antigo invalidado.
- O botÃ£o de reenviar cÃ³digo deve estar disponÃ­vel pela primeira vez apÃ³s 60 segundos.
- Durante a validaÃ§Ã£o do cÃ³digo fornecido, o link de reenviar e o botÃ£o de validar devem ficar desabilitados. O CTA deve exibir a mensagem **"Validando"**.
- O reenvio do cÃ³digo tem o limite de **5 tentativas por hora**.
- Caso exista um erro, a mensagem de erro Ã© aplicada ao bloco inteiro, mudando de cor (texto e inputs em vermelho).
  - Inputs vazios â†’ "Preencha todos os campos para continuar".
  - CÃ³digo incorreto â†’ "Preencha corretamente ou reenvie o cÃ³digo e tente novamente".
- O cadastro sÃ³ poderÃ¡ prosseguir apÃ³s a validaÃ§Ã£o correta do cÃ³digo.
- Caso o cÃ³digo seja invÃ¡lido ou expirado, o sistema deve solicitar novo envio.
- Se atingir o limite de 5 cÃ³digos invÃ¡lidos, apenas serÃ¡ possÃ­vel gerar um novo apÃ³s 1 hora.
- Ao atingir o limite, exibir mensagem em vermelho: **"VocÃª sÃ³ poderÃ¡ solicitar novamente o cÃ³digo apÃ³s 1 hora"**.

---

## 3. Dados ObrigatÃ³rios

- O sistema deve exigir o preenchimento de todos os campos obrigatÃ³rios (ex.: nome completo, data de nascimento, gÃªnero, cidade, CEP).
- Ao inserir o CEP, o sistema deverÃ¡ efetuar a validaÃ§Ã£o do CEP digitado.
- Ao clicar no link "Busca CEP", a pÃ¡gina exibida deverÃ¡ ser a pÃ¡gina de busca de CEP dos Correios.
- UsuÃ¡rios do perfil **Paciente** devem preencher tambÃ©m preferÃªncias de atendimento e acessibilidade.
- UsuÃ¡rios do perfil **Profissional** devem preencher especialidades, registro profissional e disponibilidade.
- Em caso de dados nÃ£o preenchidos ou incorretos, o label e a caixa ficam vermelhos, com texto de apoio abaixo.
- O cadastro nÃ£o pode ser concluÃ­do se algum campo obrigatÃ³rio estiver em branco.

---

## 3.1 ValidaÃ§Ãµes Detalhadas

### 3.1.1 ğŸ“‹ ValidaÃ§Ãµes do formulÃ¡rio (Paciente)

## ğŸ‘¤ Nome
- MÃ­nimo 3 caracteres.
- Pode conter espaÃ§os, mas apenas **um espaÃ§o entre palavras**.

## ğŸ‚ Data de Nascimento
- NÃ£o pode ser mais antiga que 110 anos atrÃ¡s.
- UsuÃ¡rio deve ter **mÃ­nimo de 18 anos** para se cadastrar.

## ğŸ  CEP Residencial
- Exatamente 9 caracteres no formato `00000-000`.
- Valida via **ViaCEP** â†’ se nÃ£o existir, retorna "CEP nÃ£o encontrado".

## ğŸ“Œ EndereÃ§o Residencial
- MÃ­nimo 3 caracteres.
 
## ğŸ™ï¸ Bairro Residencial
- MÃ­nimo 3 caracteres.

## ğŸŒ† Cidade Residencial
- MÃ­nimo 3 caracteres.

## ğŸ—ºï¸ Estado Residencial
- MÃ­nimo 3 caracteres.

## â™¿ Accessibilidade
- Aceita uma lista (array) de opÃ§Ãµes em texto.
   - Exemplo: `["rampa", "banheiro adaptado"]`.
- Pode ser vazio ou conter mÃºltiplos itens.

## ğŸ©º Especialidades
- Pelo menos **1 especialidade selecionada**.
- Aceita lista (array) de opÃ§Ãµes em texto.

## âš™ï¸ PreferÃªncias 
- Aceita lista (array) de opÃ§Ãµes em texto.
- Pode ser vazio ou conter mÃºltiplos itens.


---

### 3.1.2 ğŸ“‹ ValidaÃ§Ãµes do formulÃ¡rio (Profissional)

## ğŸ‘¤ Nome
- MÃ­nimo 10 caracteres.
- Apenas letras (com acentos).
- Apenas 1 espaÃ§o entre palavras.

## ğŸ‚ Data de Nascimento
- NÃ£o pode ser mais antiga que 110 anos atrÃ¡s.
- UsuÃ¡rio deve ter **mÃ­nimo de 18 anos**.

## ğŸ  CEP Residencial
- Exatamente 9 caracteres no formato `00000-000`.
- Valida via **ViaCEP** â†’ se nÃ£o existir, retorna "CEP nÃ£o encontrado".

## ğŸ“Œ EndereÃ§o Residencial
- MÃ­nimo 3 caracteres.

## ğŸ™ï¸ Bairro Residencial
- MÃ­nimo 3 caracteres.

## ğŸŒ† Cidade Residencial
- MÃ­nimo 3 caracteres.

## ğŸ—ºï¸ Estado Residencial
- MÃ­nimo 3 caracteres.

## ğŸ¥ Nome da ClÃ­nica
- MÃ­nimo 3 caracteres.

## ğŸ†” CPF / CNPJ
- Entre 11 e 18 caracteres.
- Deve validar se Ã© **CPF ou CNPJ real**.
- Mensagem de erro: **"CNPJ ou CPF invÃ¡lido"**.

## ğŸ  CEP Profissional
- Exatamente 9 caracteres no formato `00000-000`.
- Valida via **ViaCEP** â†’ retorna "CEP nÃ£o encontrado" se invÃ¡lido.

## ğŸ“Œ EndereÃ§o da ClÃ­nica
- MÃ­nimo 5 caracteres.

## ğŸ™ï¸ Bairro da ClÃ­nica
- MÃ­nimo 3 caracteres.

## ğŸ”¢ NÃºmero da ClÃ­nica
- Deve ser **nÃºmero â‰¥ 1**.

## ğŸ“ Complemento da ClÃ­nica
- Campo opcional (string livre).

## ğŸŒ† Cidade da ClÃ­nica
- MÃ­nimo 3 caracteres.

## ğŸ—ºï¸ Estado da ClÃ­nica
- MÃ­nimo 3 caracteres.

## ğŸ©º Especialidades
- Pelo menos **1 especialidade selecionada**.
- Aceita lista (array) de opÃ§Ãµes em texto.

**âš™ï¸ Service Preferences**
- Aceita lista (array) de opÃ§Ãµes em texto.
- Campo pode ser **nulo (null)** ou conter mÃºltiplos itens.

## ğŸ’¡ Suggestions
- Pelo menos 1 caractere.
- Mensagem de erro: **"SugestÃ£o invÃ¡lida"** se vazio.

---

## 4. Fluxo de ConclusÃ£o

- O cadastro sÃ³ serÃ¡ considerado concluÃ­do quando todos os dados obrigatÃ³rios forem validados.
- ApÃ³s a conclusÃ£o, o usuÃ¡rio deve ser automaticamente redirecionado para a Home autenticado.
- O sistema deve registrar a data e hora da criaÃ§Ã£o do cadastro.
- Se o usuÃ¡rio jÃ¡ tiver conta, ele serÃ¡ redirecionado para a Home apÃ³s logar com e-mail ou Google/Facebook.

---

## 5. RestriÃ§Ãµes e ValidaÃ§Ãµes Gerais

- NÃ£o Ã© permitido cadastrar o mesmo e-mail mais de uma vez.
- Perfis diferentes (Paciente e Profissional) nÃ£o podem compartilhar o mesmo e-mail.
- O sistema deve exibir mensagens claras em caso de erro (ex.: e-mail jÃ¡ cadastrado, cÃ³digo invÃ¡lido, falta de conexÃ£o).
- Em caso de falha de conexÃ£o durante o cadastro, o processo deve ser interrompido e o usuÃ¡rio informado para tentar novamente.

